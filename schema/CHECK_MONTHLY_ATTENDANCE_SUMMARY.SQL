-- Monthly Attendance Summary per Employee
SELECT 
    EMPLOYEE_ID,
    TO_CHAR(ATTENDANCE_DATE, 'YYYY-MM') AS MONTH,
    COUNT(*) AS TOTAL_DAYS,
    SUM(CASE WHEN STATUS = 'PRESENT' THEN 1 ELSE 0 END) AS PRESENT_DAYS,
    SUM(CASE WHEN STATUS = 'ABSENT' THEN 1 ELSE 0 END) AS ABSENT_DAYS,
    SUM(CASE WHEN STATUS = 'ON LEAVE' THEN 1 ELSE 0 END) AS LEAVE_DAYS,
    SUM(CASE WHEN STATUS = 'HALF DAY' THEN 1 ELSE 0 END) AS HALF_DAYS
FROM ATTENDANCE
GROUP BY EMPLOYEE_ID, TO_CHAR(ATTENDANCE_DATE, 'YYYY-MM')
ORDER BY EMPLOYEE_ID, MONTH;

